RSpec.describe "the parser and the SAP configuration (for Northern Ireland)" do
  let(:use_case) { UseCase::ParseXmlCertificate.new }

  context "when loading XML from RdSAP (SAP NI 16.0)" do
    let(:rdsap) { Samples.xml "SAP-Schema-NI-16.0", "rdsap" }

    it "parses the document into the expected format" do
      expectation = { "calculation_software_version" => 4.1,
                      "calculation_software_name" => "Epc Reporter",
                      "sap_version" => 9.91,
                      "walls" =>
                        [{ "description" => "Granite or whinstone, as built, no insulation (assumed)",
                           "energy_efficiency_rating" => 1,
                           "environmental_efficiency_rating" => 1 },
                         { "description" => "Solid brick, as built, no insulation (assumed)",
                           "energy_efficiency_rating" => 2,
                           "environmental_efficiency_rating" => 2 },
                         { "description" => "Cavity wall, as built, partial insulation (assumed)",
                           "energy_efficiency_rating" => 3,
                           "environmental_efficiency_rating" => 3 }],
                      "roofs" =>
                        [{ "description" => "Pitched, no insulation",
                           "energy_efficiency_rating" => 1,
                           "environmental_efficiency_rating" => 1 },
                         { "description" => "Pitched, 100mm loft insulation",
                           "energy_efficiency_rating" => 3,
                           "environmental_efficiency_rating" => 3 },
                         { "description" => "Flat, limited insulation (assumed)",
                           "energy_efficiency_rating" => 2,
                           "environmental_efficiency_rating" => 2 }],
                      "floors" =>
                        [{ "description" => "Solid, no insulation (assumed)",
                           "energy_efficiency_rating" => 0,
                           "environmental_efficiency_rating" => 0 }],
                      "windows" =>
                        [{ "description" => "Partial double glazing",
                           "energy_efficiency_rating" => 2,
                           "environmental_efficiency_rating" => 2 }],
                      "main_heating" =>
                        [{ "description" => "Boiler and radiators, oil",
                           "energy_efficiency_rating" => 3,
                           "environmental_efficiency_rating" => 3 }],
                      "main_heating_controls" =>
                        [{ "description" => "Programmer, TRVs and bypass",
                           "energy_efficiency_rating" => 3,
                           "environmental_efficiency_rating" => 3 }],
                      "hot_water" =>
                        { "description" => "From main system, no cylinder thermostat",
                          "energy_efficiency_rating" => 2,
                          "environmental_efficiency_rating" => 1 },
                      "lighting" =>
                        { "description" => "No low energy lighting",
                          "energy_efficiency_rating" => 1,
                          "environmental_efficiency_rating" => 1 },
                      "secondary_heating" =>
                        { "description" => "Room heaters, dual fuel (mineral and wood)",
                          "energy_efficiency_rating" => 0,
                          "environmental_efficiency_rating" => 0 },
                      "has_hot_water_cylinder" => "true",
                      "has_heated_separate_conservatory" => "false",
                      "dwelling_type" => "Detached bungalow",
                      "total_floor_area" => 90,
                      "has_fixed_air_conditioning" => "false",
                      "energy_rating_average" => 57,
                      "energy_rating_current" => 22,
                      "energy_rating_potential" => 53,
                      "environmental_impact_current" => 16,
                      "environmental_impact_potential" => 41,
                      "energy_consumption_current" => { "quantity" => "kWh/m2 per year", "value" => 524 },
                      "energy_consumption_potential" => { "quantity" => "kWh/m2 per year", "value" => 289 },
                      "co2_emissions_current" => { "quantity" => "tonnes per year", "value" => 11 },
                      "co2_emissions_potential" => { "quantity" => "tonnes per year", "value" => 6.3 },
                      "co2_emissions_current_per_floor_area" =>
                        { "quantity" => "kg/m2 per year", "value" => 128 },
                      "lighting_cost_current" => { "currency" => "GBP", "value" => 96 },
                      "lighting_cost_potential" => { "currency" => "GBP", "value" => 48 },
                      "heating_cost_current" => { "currency" => "GBP", "value" => 1606 },
                      "heating_cost_potential" => { "currency" => "GBP", "value" => 919 },
                      "hot_water_cost_current" => { "currency" => "GBP", "value" => 313 },
                      "hot_water_cost_potential" => { "currency" => "GBP", "value" => 139 },
                      "suggested_improvements" =>
                        [{ "sequence" => 1,
                           "improvement_type" => "A",
                           "indicative_cost" => "£100 - £350",
                           "improvement_category" => 1,
                           "typical_saving" => { "currency" => "GBP", "value" => 203 },
                           "energy_performance_rating" => 27,
                           "environmental_impact_rating" => 21,
                           "improvement_details" => { "improvement_number" => 5 } },
                         { "sequence" => 2,
                           "improvement_type" => "B",
                           "indicative_cost" => "£500 - £1,500",
                           "improvement_category" => 1,
                           "typical_saving" => { "currency" => "GBP", "value" => 56 },
                           "energy_performance_rating" => 29,
                           "environmental_impact_rating" => 22,
                           "improvement_details" => { "improvement_number" => 6 } },
                         { "sequence" => 3,
                           "improvement_type" => "C",
                           "indicative_cost" => "£15 - £30",
                           "improvement_category" => 1,
                           "typical_saving" => { "currency" => "GBP", "value" => 38 },
                           "energy_performance_rating" => 30,
                           "environmental_impact_rating" => 23,
                           "improvement_details" => { "improvement_number" => 3 } },
                         { "sequence" => 4,
                           "improvement_type" => "D",
                           "indicative_cost" => "£80 - £120",
                           "improvement_category" => 1,
                           "typical_saving" => { "currency" => "GBP", "value" => 23 },
                           "energy_performance_rating" => 31,
                           "environmental_impact_rating" => 24,
                           "improvement_details" => { "improvement_number" => 10 } },
                         { "sequence" => 5,
                           "improvement_type" => "E",
                           "indicative_cost" => "£50",
                           "improvement_category" => 1,
                           "typical_saving" => { "currency" => "GBP", "value" => 37 },
                           "energy_performance_rating" => 32,
                           "environmental_impact_rating" => 24,
                           "improvement_details" => { "improvement_number" => 35 } },
                         { "sequence" => 6,
                           "improvement_type" => "F",
                           "indicative_cost" => "£200 - £400",
                           "improvement_category" => 1,
                           "typical_saving" => { "currency" => "GBP", "value" => 40 },
                           "energy_performance_rating" => 33,
                           "environmental_impact_rating" => 25,
                           "improvement_details" => { "improvement_number" => 4 } },
                         { "sequence" => 7,
                           "improvement_type" => "G",
                           "indicative_cost" => "£350 - £450",
                           "improvement_category" => 1,
                           "typical_saving" => { "currency" => "GBP", "value" => 103 },
                           "energy_performance_rating" => 37,
                           "environmental_impact_rating" => 28,
                           "improvement_details" => { "improvement_number" => 14 } },
                         { "sequence" => 8,
                           "improvement_type" => "W",
                           "indicative_cost" => "£800 - £1,200",
                           "improvement_category" => 2,
                           "typical_saving" => { "currency" => "GBP", "value" => 142 },
                           "energy_performance_rating" => 42,
                           "environmental_impact_rating" => 32,
                           "improvement_details" => { "improvement_number" => 47 } },
                         { "sequence" => 9,
                           "improvement_type" => "I",
                           "indicative_cost" => "£2,200 - £3,000",
                           "improvement_category" => 2,
                           "typical_saving" => { "currency" => "GBP", "value" => 268 },
                           "energy_performance_rating" => 53,
                           "environmental_impact_rating" => 41,
                           "improvement_details" => { "improvement_number" => 20 } },
                         { "sequence" => 10,
                           "improvement_type" => "N",
                           "indicative_cost" => "£4,000 - £6,000",
                           "improvement_category" => 3,
                           "typical_saving" => { "currency" => "GBP", "value" => 46 },
                           "energy_performance_rating" => 55,
                           "environmental_impact_rating" => 43,
                           "improvement_details" => { "improvement_number" => 19 } },
                         { "sequence" => 11,
                           "improvement_type" => "O",
                           "indicative_cost" => "£3,300 - £6,500",
                           "improvement_category" => 3,
                           "typical_saving" => { "currency" => "GBP", "value" => 56 },
                           "energy_performance_rating" => 58,
                           "environmental_impact_rating" => 46,
                           "improvement_details" => { "improvement_number" => 8 } },
                         { "sequence" => 12,
                           "improvement_type" => "Q",
                           "indicative_cost" => "£4,000 - £14,000",
                           "improvement_category" => 3,
                           "typical_saving" => { "currency" => "GBP", "value" => 92 },
                           "energy_performance_rating" => 61,
                           "environmental_impact_rating" => 50,
                           "improvement_details" => { "improvement_number" => 7 } },
                         { "sequence" => 13,
                           "improvement_type" => "U",
                           "indicative_cost" => "£9,000 - £14,000",
                           "improvement_category" => 3,
                           "typical_saving" => { "currency" => "GBP", "value" => 205 },
                           "energy_performance_rating" => 71,
                           "environmental_impact_rating" => 58,
                           "improvement_details" => { "improvement_number" => 34 } },
                         { "sequence" => 14,
                           "improvement_type" => "V",
                           "indicative_cost" => "£1,500 - £4,000",
                           "improvement_category" => 3,
                           "typical_saving" => { "currency" => "GBP", "value" => 78 },
                           "energy_performance_rating" => 74,
                           "environmental_impact_rating" => 61,
                           "improvement_details" => { "improvement_number" => 44 } }],
                      "addendum" => { "cavity_fill_recommended" => "true", "stone_walls" => "true" },
                      "schema_version" => "LIG-16.0",
                      "habitable_room_count" => 4,
                      "heated_room_count" => 4,
                      "conservatory_type" => 1,
                      "glazed_area" => 1,
                      "property_type" => 1,
                      "built_form" => 1,
                      "extensions_count" => 4,
                      "percent_draughtproofed" => 36,
                      "measurement_type" => 1,
                      "sap_energy_source" =>
                        { "wind_turbines_terrain_type" => 3,
                          "wind_turbines_count" => 0,
                          "meter_type" => 2,
                          "main_gas" => "N",
                          "photovoltaic_supply" => { "percent_roof_area" => 0 } },
                      "mechanical_ventilation" => 0,
                      "sap_heating" =>
                        { "has_fixed_air_conditioning" => "false",
                          "cylinder_size" => 2,
                          "water_heating_code" => 901,
                          "water_heating_fuel" => 28,
                          "cylinder_insulation_type" => 1,
                          "cylinder_insulation_thickness" => 12,
                          "cylinder_thermostat" => "N",
                          "main_heating_details" =>
                           [{ "main_heating_data_source" => 2,
                              "main_heating_category" => 2,
                              "main_fuel_type" => 28,
                              "sap_main_heating_code" => 125,
                              "main_heating_control" => 2107,
                              "boiler_flue_type" => 1,
                              "fan_flue_present" => "N",
                              "heat_emitter_type" => 1,
                              "main_heating_fraction" => 1,
                              "has_fghrs" => "N",
                              "main_heating_number" => 1 }],
                          "wwhrs" =>
                           { "rooms_with_bath_and_or_shower" => 1,
                             "rooms_with_mixer_shower_no_bath" => 0,
                             "rooms_with_bath_and_mixer_shower" => 0 },
                          "secondary_heating_type" => 631,
                          "secondary_fuel_type" => 9 },
                      "door_count" => 2,
                      "insulated_door_count" => 0,
                      "multiple_glazed_proportion" => 35,
                      "multiple_glazing_type" => 3,
                      "low_energy_lighting" => 0,
                      "fixed_lighting_outlets_count" => 10,
                      "low_energy_fixed_lighting_outlets_count" => 0,
                      "solar_water_heating" => "N",
                      "sap_building_parts" =>
                        [{ "construction_age_band" => "A",
                           "wall_construction" => 1,
                           "wall_insulation_type" => 5,
                           "wall_thickness_measured" => "Y",
                           "wall_thickness" => 450,
                           "wall_dry_lined" => "Y",
                           "roof_construction" => 4,
                           "roof_insulation_location" => 5,
                           "roof_insulation_thickness" => "NI",
                           "floor_heat_loss" => 7,
                           "sap_floor_dimensions" =>
                            [{ "floor_construction" => 1,
                               "floor_insulation" => 1,
                               "total_floor_area" => 29.42,
                               "room_height" => 2.35,
                               "heat_loss_perimeter" => 9.24,
                               "floor" => 0 }],
                           "building_part_number" => 1,
                           "identifier" => "Main Dwelling" },
                         { "construction_age_band" => "A",
                           "wall_construction" => 1,
                           "wall_insulation_type" => 5,
                           "wall_thickness_measured" => "Y",
                           "wall_thickness" => 450,
                           "wall_dry_lined" => "Y",
                           "roof_construction" => 4,
                           "roof_insulation_location" => 2,
                           "roof_insulation_thickness" => "100mm",
                           "floor_heat_loss" => 7,
                           "sap_floor_dimensions" =>
                            [{ "floor_construction" => 1,
                               "floor_insulation" => 1,
                               "total_floor_area" => 16.61,
                               "room_height" => 2.32,
                               "heat_loss_perimeter" => 10.31,
                               "floor" => 0 }],
                           "building_part_number" => 2,
                           "identifier" => "Extension 1" },
                         { "construction_age_band" => "C",
                           "wall_construction" => 3,
                           "wall_insulation_type" => 5,
                           "wall_thickness_measured" => "Y",
                           "wall_thickness" => 200,
                           "wall_dry_lined" => "Y",
                           "roof_construction" => 1,
                           "roof_insulation_location" => 4,
                           "roof_insulation_thickness" => "ND",
                           "floor_heat_loss" => 7,
                           "sap_floor_dimensions" =>
                            [{ "floor_construction" => 1,
                               "floor_insulation" => 1,
                               "total_floor_area" => 10.07,
                               "room_height" => 2.42,
                               "heat_loss_perimeter" => 8.23,
                               "floor" => 0 }],
                           "building_part_number" => 3,
                           "identifier" => "Extension 2" },
                         { "construction_age_band" => "C",
                           "wall_construction" => 3,
                           "wall_insulation_type" => 4,
                           "wall_thickness_measured" => "Y",
                           "wall_thickness" => 175,
                           "wall_dry_lined" => "N",
                           "roof_construction" => 1,
                           "roof_insulation_location" => 4,
                           "roof_insulation_thickness" => "ND",
                           "floor_heat_loss" => 7,
                           "sap_floor_dimensions" =>
                            [{ "floor_construction" => 1,
                               "floor_insulation" => 1,
                               "total_floor_area" => 6.52,
                               "room_height" => 2.38,
                               "heat_loss_perimeter" => 9.84,
                               "floor" => 0 }],
                           "building_part_number" => 4,
                           "identifier" => "Extension 3" },
                         { "construction_age_band" => "F",
                           "wall_construction" => 4,
                           "wall_insulation_type" => 4,
                           "wall_thickness_measured" => "Y",
                           "wall_thickness" => 315,
                           "wall_dry_lined" => "N",
                           "roof_construction" => 1,
                           "roof_insulation_location" => 4,
                           "roof_insulation_thickness" => "ND",
                           "floor_heat_loss" => 7,
                           "sap_floor_dimensions" =>
                            [{ "floor_construction" => 1,
                               "floor_insulation" => 1,
                               "total_floor_area" => 27.08,
                               "room_height" => 2.33,
                               "heat_loss_perimeter" => 15.85,
                               "floor" => 0 }],
                           "building_part_number" => 5,
                           "identifier" => "Extension 4" }],
                      "open_fireplaces_count" => 1,
                      "bedf_revision_number" => 321,
                      "inspection_date" => "2012-06-15",
                      "report_type" => 2,
                      "completion_date" => "2012-06-23",
                      "registration_date" => "2012-06-23",
                      "status" => "entered",
                      "language_code" => 1,
                      "restricted_access" => 1,
                      "seller_commission_report" => "Y",
                      "region_code" => 10,
                      "country_code" => "NIR",
                      "transaction_type" => 4,
                      "scheme_assessor_id" => "ORIG000001",
                      "address_line_1" => "1, Some Street",
                      "post_town" => "Posttown",
                      "postcode" => "BT6 3ED",
                      "uprn" => 5_555_555_555 }

      result = use_case.execute(xml: rdsap,
                                schema_type: "SAP-Schema-NI-16.0",
                                assessment_id: "1234-1234-1234-1234-1234")

      expect(result).to eq expectation
    end
  end

  context "when loading XML from SAP (SAP NI 16.0)" do
    let(:sap) { Samples.xml "SAP-Schema-NI-16.0", "sap" }

    it "parses the document into the expected format" do
      expectation = { "sap_version" => 9.81,
                      "bedf_revision_number" => 323,
                      "calculation_software_name" => "Plan Assessor",
                      "calculation_software_version" => 4.5,
                      "inspection_date" => "2012-03-14",
                      "report_type" => 3,
                      "completion_date" => "2012-06-14",
                      "registration_date" => "2012-06-14",
                      "status" => "entered",
                      "language_code" => 1,
                      "restricted_access" => 0,
                      "transaction_type" => 6,
                      "seller_commission_report" => "Y",
                      "property_type" => 0,
                      "scheme_assessor_id" => "SCHE00001",
                      "address_line_1" => "1 The Lodge",
                      "address_line_2" => "20 Some Road",
                      "post_town" => "Post Town",
                      "postcode" => "BT3 4RF",
                      "uprn" => 5_555_555_555,
                      "region_code" => 10,
                      "country_code" => "NIR",
                      "assessment_date" => "2012-03-14",
                      "walls" =>
                       [{ "description" => "Average thermal transmittance 0.31 W/m²K",
                          "energy_efficiency_rating" => 4,
                          "environmental_efficiency_rating" => 4 }],
                      "roofs" =>
                       [{ "description" => "Average thermal transmittance 0.18 W/m²K",
                          "energy_efficiency_rating" => 4,
                          "environmental_efficiency_rating" => 4 }],
                      "floors" =>
                       [{ "description" => "Average thermal transmittance 0.25 W/m²K",
                          "energy_efficiency_rating" => 4,
                          "environmental_efficiency_rating" => 4 }],
                      "windows" =>
                       { "description" => "Fully double glazed",
                         "energy_efficiency_rating" => 4,
                         "environmental_efficiency_rating" => 4 },
                      "main_heating" =>
                       [{ "description" => "Boiler and radiators, oil",
                          "energy_efficiency_rating" => 4,
                          "environmental_efficiency_rating" => 4 }],
                      "main_heating_controls" =>
                       [{ "description" => "Time and temperature zone control",
                          "energy_efficiency_rating" => 4,
                          "environmental_efficiency_rating" => 4 }],
                      "secondary_heating" =>
                       { "description" => "None",
                         "energy_efficiency_rating" => 0,
                         "environmental_efficiency_rating" => 0 },
                      "hot_water" =>
                       { "description" => "From main system",
                         "energy_efficiency_rating" => 4,
                         "environmental_efficiency_rating" => 4 },
                      "lighting" =>
                       { "description" => "Low energy lighting in 52% of fixed outlets",
                         "energy_efficiency_rating" => 4,
                         "environmental_efficiency_rating" => 4 },
                      "air_tightness" =>
                       { "description" => "Air permeability 9.8 m³/h.m² (as tested)",
                         "energy_efficiency_rating" => 3,
                         "environmental_efficiency_rating" => 3 },
                      "has_fixed_air_conditioning" => "false",
                      "has_hot_water_cylinder" => "true",
                      "has_heated_separate_conservatory" => "false",
                      "dwelling_type" => "Semi-detached house",
                      "total_floor_area" => 590,
                      "energy_rating_current" => 80,
                      "energy_rating_potential" => 82,
                      "environmental_impact_current" => 78,
                      "environmental_impact_potential" => 79,
                      "energy_consumption_current" => 85,
                      "energy_consumption_potential" => 80,
                      "co2_emissions_current" => 10,
                      "co2_emissions_current_per_floor_area" => 17,
                      "co2_emissions_potential" => 9.9,
                      "lighting_cost_current" => 568,
                      "lighting_cost_potential" => 383,
                      "heating_cost_current" => 1177,
                      "heating_cost_potential" => 1216,
                      "hot_water_cost_current" => 304,
                      "hot_water_cost_potential" => 304,
                      "suggested_improvements" =>
                       [{ "sequence" => 1,
                          "improvement_category" => 1,
                          "improvement_type" => "E",
                          "improvement_details" => { "improvement_number" => 35 },
                          "typical_saving" => 146,
                          "energy_performance_rating" => 82,
                          "environmental_impact_rating" => 79 },
                        { "sequence" => 2,
                          "improvement_category" => 3,
                          "improvement_type" => "U",
                          "improvement_details" => { "improvement_number" => 34 },
                          "typical_saving" => 212,
                          "energy_performance_rating" => 84,
                          "environmental_impact_rating" => 81 }],
                      "data_type" => 2,
                      "schema_version" => "LIG-14.0",
                      "built_form" => 2,
                      "living_area" => 58.14,
                      "orientation" => 0,
                      "conservatory_type" => 1,
                      "has_special_feature" => "false",
                      "is_in_smoke_control_area" => "unknown",
                      "additional_allowable_electricity_generation" => 0,
                      "sap_heating" =>
                       { "main_heating_category" => 2,
                         "main_heating_data_source" => 2,
                         "main_heating_make_model" => "Customer specified efficiency 90%",
                         "main_heating_efficiency" => 90,
                         "is_condensing_boiler" => "true",
                         "gas_or_oil_boiler_type" => 1,
                         "main_fuel_type" => 4,
                         "main_heating_control" => 2110,
                         "water_heating_code" => 901,
                         "water_fuel_type" => 4,
                         "has_hot_water_cylinder" => "true",
                         "heat_emitter_type" => 1,
                         "main_heating_flue_type" => 5,
                         "is_flue_fan_present" => "true",
                         "is_central_heating_pump_in_heated_space" => "false",
                         "is_oil_pump_in_heated_space" => "false",
                         "is_interlocked_system" => "true",
                         "has_delayed_start_thermostat" => "false",
                         "has_load_or_weather_compensation" => "false",
                         "secondary_heating_category" => 1,
                         "thermal_store" => 1,
                         "has_fixed_air_conditioning" => "false",
                         "is_main_heating_hetas_approved" => "false",
                         "is_secondary_heating_hetas_approved" => "false",
                         "hot_water_store_size" => 300,
                         "hot_water_store_heat_loss_source" => 3,
                         "hot_water_store_insulation_type" => 1,
                         "hot_water_store_insulation_thickness" => 100,
                         "is_primary_pipework_insulated" => "true",
                         "has_cylinder_thermostat" => "true",
                         "is_cylinder_in_heated_space" => "true",
                         "is_hot_water_separately_timed" => "true",
                         "has_solar_panel" => "false" },
                      "sap_energy_source" =>
                       { "pv_peak_power" => 0,
                         "wind_turbines_count" => 0,
                         "wind_turbine_terrain_type" => 1,
                         "fixed_lighting_outlets_count" => 52,
                         "low_energy_fixed_lighting_outlets_count" => 25,
                         "low_energy_fixed_lighting_outlets_percentage" => 48,
                         "electricity_tariff" => 1 },
                      "sap_building_parts" =>
                       [{ "building_part_number" => 1,
                          "construction_year" => 2009,
                          "overshading" => 1,
                          "sap_openings" =>
                           [{ "name" => 2,
                              "type" => 2,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.9,
                              "height" => 2.1 },
                            { "name" => 3,
                              "type" => 3,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.9,
                              "height" => 2.1 },
                            { "name" => 4,
                              "type" => 4,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.9,
                              "height" => 2.1 },
                            { "name" => 5,
                              "type" => 5,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 6,
                              "type" => 6,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 7,
                              "type" => 7,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 8,
                              "type" => 8,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 9,
                              "type" => 9,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 10,
                              "type" => 10,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 11,
                              "type" => 11,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 12,
                              "type" => 12,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 13,
                              "type" => 13,
                              "location" => "BACK",
                              "orientation" => 8,
                              "width" => 0.9,
                              "height" => 1.05 },
                            { "name" => 14,
                              "type" => 14,
                              "location" => "BACK",
                              "orientation" => 8,
                              "width" => 0.9,
                              "height" => 1.05 },
                            { "name" => 15,
                              "type" => 15,
                              "location" => "BACK",
                              "orientation" => 0,
                              "width" => 0.9,
                              "height" => 2.1 },
                            { "name" => 16,
                              "type" => 16,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 17,
                              "type" => 17,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 18,
                              "type" => 18,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 19,
                              "type" => 19,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 20,
                              "type" => 20,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 21,
                              "type" => 21,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 22,
                              "type" => 22,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 23,
                              "type" => 23,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 29,
                              "type" => 29,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 30,
                              "type" => 30,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 1.6,
                              "height" => 1.05 },
                            { "name" => 31,
                              "type" => 31,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.9,
                              "height" => 2.1 },
                            { "name" => 32,
                              "type" => 32,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.9,
                              "height" => 2.1 },
                            { "name" => 33,
                              "type" => 33,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.25,
                              "height" => 2.1 },
                            { "name" => 34,
                              "type" => 34,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.25,
                              "height" => 2.1 },
                            { "name" => 35,
                              "type" => 35,
                              "location" => "RHS",
                              "orientation" => 0,
                              "width" => 1.7,
                              "height" => 2.1 },
                            { "name" => 36,
                              "type" => 36,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 37,
                              "type" => 37,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 38,
                              "type" => 38,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 39,
                              "type" => 39,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 40,
                              "type" => 40,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 41,
                              "type" => 41,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 42,
                              "type" => 42,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 43,
                              "type" => 43,
                              "location" => "RHS",
                              "orientation" => 2,
                              "width" => 0.6,
                              "height" => 1.05 },
                            { "name" => 44,
                              "type" => 44,
                              "location" => "Roof 1",
                              "orientation" => 4,
                              "width" => 0.55,
                              "height" => 0.98 },
                            { "name" => 45,
                              "type" => 45,
                              "location" => "Roof 1",
                              "orientation" => 4,
                              "width" => 0.55,
                              "height" => 0.98 },
                            { "name" => 46,
                              "type" => 46,
                              "location" => "Roof 1",
                              "orientation" => 4,
                              "width" => 0.55,
                              "height" => 0.98 },
                            { "name" => 47,
                              "type" => 47,
                              "location" => "Roof 1",
                              "orientation" => 4,
                              "width" => 0.55,
                              "height" => 0.98 },
                            { "name" => 48,
                              "type" => 48,
                              "location" => "Roof 1",
                              "orientation" => 8,
                              "width" => 0.78,
                              "height" => 0.98 },
                            { "name" => 49,
                              "type" => 49,
                              "location" => "Roof 1",
                              "orientation" => 8,
                              "width" => 0.78,
                              "height" => 0.98 },
                            { "name" => 50,
                              "type" => 50,
                              "location" => "Roof 1",
                              "orientation" => 8,
                              "width" => 0.78,
                              "height" => 0.98 },
                            { "name" => 51,
                              "type" => 51,
                              "location" => "Roof 1",
                              "orientation" => 8,
                              "width" => 0.78,
                              "height" => 0.98 },
                            { "name" => 52,
                              "type" => 52,
                              "location" => "Roof 1",
                              "orientation" => 8,
                              "width" => 0.78,
                              "height" => 0.98 },
                            { "name" => 53,
                              "type" => 53,
                              "location" => "Roof 1",
                              "orientation" => 8,
                              "width" => 0.78,
                              "height" => 0.98 },
                            { "name" => 1,
                              "type" => 1,
                              "location" => "FRONT",
                              "orientation" => 4,
                              "width" => 0.9,
                              "height" => 2.1 },
                            { "name" => 24,
                              "type" => 24,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 25,
                              "type" => 25,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 26,
                              "type" => 26,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 27,
                              "type" => 27,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 },
                            { "name" => 28,
                              "type" => 28,
                              "location" => "LHS",
                              "orientation" => 6,
                              "width" => 0.8,
                              "height" => 1.35 }],
                          "sap_exposed_roofs" =>
                           { "sap_exposed_roof" =>
                              { "name" => "Roof 1",
                                "description" => "No information",
                                "total_roof_area" => 43.95,
                                "u_value" => 0.18 } },
                          "sap_floor_dimensions" =>
                           [{ "storey" => 0,
                              "floor_type" => 2,
                              "total_floor_area" => 181.89,
                              "storey_height" => 2.5,
                              "heat_loss_area" => 181.89,
                              "u_value" => 0.25 },
                            { "storey" => 1,
                              "floor_type" => 3,
                              "total_floor_area" => 204.26,
                              "storey_height" => 2.6,
                              "heat_loss_area" => 0.0,
                              "u_value" => 0.0 },
                            { "storey" => 2,
                              "floor_type" => 3,
                              "total_floor_area" => 204.26,
                              "storey_height" => 2.65,
                              "heat_loss_area" => 0,
                              "u_value" => 0 }],
                          "sap_thermal_bridges" =>
                           { "thermal_bridge_code" => 3, "user_defined_y_value" => 0.08 },
                          "sap_exposed_walls" =>
                           { "sap_exposed_wall" =>
                              { "name" => "RHS Dormer Cheek",
                                "description" => "Cavity construction",
                                "wall_type" => 2,
                                "total_wall_area" => 1.06,
                                "u_value" => 0.29,
                                "is_curtain_walling" => "false" } } }],
                      "sap_opening_types" =>
                       [{ "name" => 2,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 3,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 4,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 5,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 6,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 7,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 8,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 9,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 10,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 11,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 12,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 13,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 14,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 15,
                          "description" => "Door",
                          "data_source" => 3,
                          "type" => 1,
                          "glazing_type" => 1,
                          "frame_type" => 2,
                          "u_value" => 3 },
                        { "name" => 16,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 17,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 18,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 19,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 20,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 21,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 22,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 23,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 29,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 30,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 31,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 32,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 33,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 34,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 35,
                          "description" => "Door",
                          "data_source" => 3,
                          "type" => 1,
                          "glazing_type" => 1,
                          "frame_type" => 2,
                          "u_value" => 3 },
                        { "name" => 36,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 37,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 38,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 39,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 40,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 41,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 42,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 43,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 44,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 45,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 46,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 47,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 48,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 49,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 50,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 51,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 52,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 53,
                          "description" => "Rooflight",
                          "data_source" => 4,
                          "type" => 5,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 1,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 1,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 24,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 25,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 26,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 27,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 },
                        { "name" => 28,
                          "description" => "window",
                          "data_source" => 4,
                          "type" => 4,
                          "glazing_type" => 6,
                          "glazing_gap" => 3,
                          "isargonfilled" => "true",
                          "frame_type" => 2,
                          "solar_transmittance" => 0.76,
                          "u_value" => 1.8 }],
                      "sap_ventilation" =>
                       { "open_fireplaces_count" => 0,
                         "open_flues_count" => 0,
                         "fans_vents_count" => 18,
                         "flueless_gas_fires_count" => 0,
                         "pressure_test" => 1,
                         "air_permeability" => 9.77,
                         "ground_floor_type" => 1,
                         "wall_type" => 2,
                         "sheltered_sides_count" => 2,
                         "ventilation_type" => 1,
                         "mechanical_vent_specific_fan_power" => 0.0 } }

      result = use_case.execute(xml: sap,
                                schema_type: "SAP-Schema-NI-16.0",
                                assessment_id: "1234-1234-1234-1234-1234")

      expect(result).to eq expectation
    end
  end
end
